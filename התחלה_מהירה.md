# CartWise Pro - מדריך התחלה מהירה
## מערכת ניהול עגלות חכמות - הפעלה תוך 5 דקות

---

## 🚀 התקנה מהירה

### שלב 1: התקנת תלויות (2 דקות)

```bash
cd CartWise-Pro
pip3 install -r requirements.txt
```

**אם מקבלים שגיאה על "externally-managed-environment":**
```bash
pip3 install -r requirements.txt --break-system-packages
```

---

### שלב 2: הגדרת קובץ תצורה (1 דקה)

```bash
# העתקת קובץ דוגמה
cp config/.env.example config/.env

# עריכת ההגדרות
nano config/.env
```

**ערכו את השדות הבאים:**
```env
# פרטי Inforu SMS (חובה!)
INFORU_USERNAME=your_username_here
INFORU_PASSWORD=your_password_here

# פורט RS485 (בדקו: ls -l /dev/ttyUSB*)
SERIAL_PORT=/dev/ttyUSB0
BAUD_RATE=9600

# הגדרות שרת
HOST=0.0.0.0
PORT=8001
```

**שמרו את הקובץ:** `Ctrl+X`, `Y`, `Enter`

---

### שלב 3: הרצת השרת (30 שניות)

```bash
python3 src/api/main.py
```

**צריכים לראות:**
```
INFO:     Started server process
INFO:     Uvicorn running on http://0.0.0.0:8001
```

---

### שלב 4: בדיקת המערכת (1 דקה)

**פתחו דפדפן וגשו:**
```
http://localhost:8001
```

או מטלפון/טאבלט:
```
http://[IP של הרספברי]:8001
```

**למציאת ה-IP:**
```bash
hostname -I
```

---

## ✅ בדיקה מהירה

### 1. בדיקת בריאות המערכת
```bash
curl http://localhost:8001/health
```
**תשובה צפויה:** `{"status":"healthy",...}`

### 2. בדיקת עגלות זמינות
```bash
curl http://localhost:8001/carts/available
```
**תשובה צפויה:** רשימת עגלות זמינות

### 3. תיעוד API
פתחו בדפדפן:
```
http://localhost:8001/docs
```

---

## 🔧 פתרון בעיות מהיר

### ❌ "Permission denied: /dev/ttyUSB0"
```bash
sudo chmod 666 /dev/ttyUSB0
sudo usermod -a -G dialout $USER
# יש להתנתק ולהתחבר מחדש
```

### ❌ "Port 8001 already in use"
```bash
# הרגת תהליך קיים
sudo lsof -ti:8001 | xargs kill

# או שנו פורט ב-.env
nano config/.env  # שנו PORT=8002
```

### ❌ "No module named 'fastapi'"
```bash
pip3 install -r requirements.txt --break-system-packages
```

### ❌ SMS לא נשלח
1. בדקו נכונות פרטי Inforu ב-`.env`
2. ודאו פורמט מספר טלפון: `05XXXXXXXX`
3. בדקו יתרת חשבון Inforu

---

## 📱 תהליך עבודה מלא

### לקוח לוקח עגלה:

1. **לקוח נכנס לממשק**
   - נכנס למסך המערכת

2. **מזין מספר טלפון**
   - מספר בפורמט: 05XXXXXXXX
   - לוחץ "קבל קוד אימות"

3. **מקבל SMS עם קוד OTP**
   - קוד בן 4 ספרות
   - תוקף: 5 דקות

4. **מזין את קוד האימות**
   - מקליד את 4 הספרות
   - לוחץ "אמת קוד"

5. **עגלה מוקצית ונפתחת**
   - המנעול נפתח (נשמע קליק)
   - SMS אישור נשלח
   - לקוח לוקח את העגלה

### לקוח מחזיר עגלה:

1. **לקוח דחף עגלה למקומה**
   - העגלה חוזרת למיקום המקורי

2. **Micro-Switch מזהה החזרה**
   - המתג נלחץ

3. **מנעול נסגר אוטומטית**
   - המערכת נועלת את המנעול

4. **עגלה מסומנת כזמינה**
   - העגלה מוכנה ללקוח הבא

---

## 🔄 הפעלה אוטומטית בהפעלת המחשב

### יצירת שירות systemd:

```bash
sudo nano /etc/systemd/system/cartwise.service
```

**הדביקו:**
```ini
[Unit]
Description=CartWise Pro
After=network.target

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/CartWise-Pro
ExecStart=/usr/bin/python3 /home/pi/CartWise-Pro/src/api/main.py
Restart=always

[Install]
WantedBy=multi-user.target
```

**הפעילו:**
```bash
sudo systemctl enable cartwise
sudo systemctl start cartwise
sudo systemctl status cartwise
```

---

## 📊 פקודות שימושיות

### ניהול השירות:
```bash
# הפעלה
sudo systemctl start cartwise

# עצירה
sudo systemctl stop cartwise

# הפעלה מחדש
sudo systemctl restart cartwise

# סטטוס
sudo systemctl status cartwise
```

### צפייה בלוגים:
```bash
# לוגים בזמן אמת
sudo journalctl -u cartwise -f

# 100 שורות אחרונות
sudo journalctl -u cartwise -n 100

# לוגים מהיום
sudo journalctl -u cartwise --since today
```

### בדיקת חיבור RS485:
```bash
# רשימת התקני USB
ls -l /dev/ttyUSB*

# בדיקת הרשאות
groups $USER | grep dialout
```

---

## 🎯 נקודות בדיקה לפני הפצה

- [ ] השרת עולה בהצלחה
- [ ] הממשק נטען בדפדפן
- [ ] SMS נשלח ומתקבל
- [ ] קוד OTP עובד
- [ ] עגלה נפתחת (מנעול)
- [ ] Micro-switch מזהה החזרה
- [ ] עגלה ננעלת אוטומטית
- [ ] הכל עובד כצפוי!

---

## 📞 קבלת עזרה

### בעיות טכניות:
- **אימייל**: support@cartwise.com
- **טלפון**: 050-XXXXXXX
- **שעות**: 9:00-17:00

### תיעוד נוסף:
- **README.md** - סקירה כללית
- **PROJECT_SUMMARY.md** - סיכום מלא
- **HANDOVER_GUIDE.md** - מדריך למפתחים
- **docs/HARDWARE.md** - פרוטוקול חומרה
- **DEPLOYMENT_CHECKLIST.md** - רשימת בדיקות

---

## 💡 טיפים מהירים

### 1. גישה מהירה מטלפון
צרו QR code:
```bash
sudo apt install qrencode
qrencode -o qr.png "http://$(hostname -I | awk '{print $1}'):8001"
```

### 2. בדיקת ביצועים
```bash
# התקנת כלי בדיקה
sudo apt install apache2-utils

# בדיקת 100 בקשות
ab -n 100 -c 10 http://localhost:8001/health
```

### 3. גיבוי הגדרות
```bash
# יצירת גיבוי
cp config/.env config/.env.backup

# שחזור גיבוי
cp config/.env.backup config/.env
```

---

## 🎉 סיימנו!

המערכת מוכנה לשימוש!

**נקודות חשובות לזכור:**
1. ✅ פרטי Inforu חייבים להיות נכונים
2. ✅ RS485 חייב להיות מחובר
3. ✅ מספרי טלפון בפורמט: 05XXXXXXXX
4. ✅ Micro-switches מותקנים ועובדים
5. ✅ השירות פועל אוטומטית בהפעלה

**בהצלחה! 🚀**

---

**תאריך יצירה:** ינואר 2025
**גרסה:** 1.0.0
**סטטוס:** מוכן לייצור ✅
